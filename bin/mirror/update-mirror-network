#!/bin/sh

set -e

MIRROR_ZONE_SUBFILE=../../db.proftpd.org-mirrors

./dns-zone >"$MIRROR_ZONE_SUBFILE.new"
if [ ! -s "$MIRROR_ZONE_SUBFILE.new" ]; then
	echo "dnsZone(1) exited successfully but $MIRROR_ZONE_SUBFILE.new is zero bytes, not committing." 1>&2
	exit 1
fi
mv -f "$MIRROR_ZONE_SUBFILE.new" "$MIRROR_ZONE_SUBFILE"
cvs commit -m 'automated update' "$MIRROR_ZONE_SUBFILE"
